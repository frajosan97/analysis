import{r,j as e,Q as j}from"./app-Xndhg5si.js";import{A as N,D as l}from"./AuthenticatedLayout-CnCLvinL.js";import{R as x,C as o,a as p}from"./Row-P0r0XRP3.js";import{T as w}from"./Table-HEjORqKt.js";import"./ApplicationLogo-BtVl2ghN.js";import"./warning-CwnM8Q9K.js";import"./CloseButton-Czk6V9C-.js";import"./index-CmqZGmBw.js";function S({exam:t,classData:a}){const[n,h]=r.useState([]),[c,m]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const d=await(await fetch(route("api.subjects"))).json();h(d),m(!1)}catch(i){console.error("Error fetching subjects:",i),m(!1)}})()},[]);const u=r.useCallback(()=>{if(!n.length||c)return;$.fn.DataTable.isDataTable("#resultsTable")&&$("#resultsTable").DataTable().destroy();const b=n.map(s=>({data:`scores.${s.code}`,title:s.short_name||s.name,render:function(f){return f||"--"},className:"text-nowrap"})),i=[{data:"adm",title:"Adm",orderable:!1},{data:"name",title:"Name",className:"text-nowrap"},{data:"class",title:"Class",className:"text-capitalize text-nowrap"},{data:"kcpe",title:"KCPE"}],d=[{data:"re_subC",title:"Count"},{data:"re_tt",title:"Marks",className:"fw-bold text-danger"},{data:"re_mean",title:"Mean",className:"fw-bold text-primary"},{data:"re_pnt",title:"Points",className:"fw-bold text-danger"},{data:"re_avgpnt",title:"Average",className:"fw-bold text-primary"},{data:"re_grade",title:"Grade",className:"fw-bold text-success"},{data:"re_sRank",title:"Rank",className:"fw-bold text-dark"},{data:"re_fRank",title:"Position",className:"fw-bold text-dark"}],g=[...i,...b,...d];$("#resultsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("results.index",{exam:t.id,class:a}),type:"GET"},columns:g,language:{emptyTable:"No results available",processing:"Loading results..."},createdRow:function(s,f,T){$("td",s).each(function(){$(this).text()==="--"&&$(this).addClass("text-muted")})}})},[t.id,a,n,c]);return r.useEffect(()=>(u(),()=>{$.fn.DataTable.isDataTable("#resultsTable")&&$("#resultsTable").DataTable().destroy()}),[u]),e.jsxs(N,{children:[e.jsx(j,{title:"Results List"}),e.jsxs(x,{className:"mb-3 align-items-center",children:[e.jsxs(o,{children:[e.jsxs("h1",{className:"h3 mb-0",children:["Form ",a," Results"]}),e.jsxs("p",{className:"text-muted mb-0",children:["Term: ",t.term.term," Exam: ",t.exam]})]}),e.jsx(o,{className:"d-flex justify-content-end",children:e.jsxs(l,{align:"end",children:[e.jsxs(l.Toggle,{variant:"outline-success",id:"dropdown-downloads",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-download me-1"}),"Downloads"]}),e.jsxs(l.Menu,{className:"border-0 shadow-sm",children:[e.jsxs(l.Item,{href:route("pdf.merit",[t.id,a]),target:"_blank",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-file-earmark-pdf text-danger"}),"Merit List - PDF"]}),e.jsxs(l.Item,{href:route("pdf.analysis",[t.id,a]),target:"_blank",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-file-earmark-pdf text-danger"}),"Analysis - PDF"]})]})]})})]}),e.jsx("hr",{className:"dashed-hr mb-4"}),e.jsx(x,{children:e.jsx(o,{xs:12,children:e.jsx(p,{className:"border-0 shadow-sm",children:e.jsx(p.Body,{children:e.jsx(w,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"resultsTable",className:"w-100 mb-0"})})})})})]})}export{S as default};
