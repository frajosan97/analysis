import{r,j as e,Q as g}from"./app-D6Mgx-7_.js";import{A as N,D as a}from"./AuthenticatedLayout-Dj-MlTJt.js";import{R as b,C as d,a as p}from"./Row-CImJcH07.js";import{T as w}from"./Table-BgAF9dV9.js";import"./ApplicationLogo-Btdk_8rf.js";import"./warning-l0Ng14cn.js";import"./CloseButton-DYsZQ_Si.js";import"./index-LoOBSOcQ.js";function S({exam:t,classData:l}){const[n,h]=r.useState([]),[c,m]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const o=await(await fetch(route("api.subjects"))).json();h(o),m(!1)}catch(i){console.error("Error fetching subjects:",i),m(!1)}})()},[]);const u=r.useCallback(()=>{if(!n.length||c)return;$.fn.DataTable.isDataTable("#resultsTable")&&$("#resultsTable").DataTable().destroy();const x=n.map(s=>({data:`scores.${s.code}`,title:s.short_name||s.name,render:function(f){return f||"--"},className:"text-nowrap"})),i=[{data:"adm",title:"Adm",orderable:!1},{data:"name",title:"Name",className:"text-nowrap"},{data:"class",title:"Class",className:"text-capitalize text-nowrap"},{data:"kcpe",title:"KCPE"}],o=[{data:"re_subC",title:"Count"},{data:"re_tt",title:"Marks",className:"fw-bold text-danger"},{data:"re_mean",title:"Mean",className:"fw-bold text-primary"},{data:"re_pnt",title:"Points",className:"fw-bold text-danger"},{data:"re_avgpnt",title:"Average",className:"fw-bold text-primary"},{data:"re_grade",title:"Grade",className:"fw-bold text-success"},{data:"re_sRank",title:"Rank",className:"fw-bold text-dark"},{data:"re_fRank",title:"Position",className:"fw-bold text-dark"}],j=[...i,...x,...o];$("#resultsTable").DataTable({processing:!0,serverSide:!0,ajax:{url:route("results.index",{exam:t.id,class:l}),type:"GET"},columns:j,language:{emptyTable:"No results available",processing:"Loading results..."},createdRow:function(s,f,T){$("td",s).each(function(){$(this).text()==="--"&&$(this).addClass("text-muted")})}})},[t.id,l,n,c]);return r.useEffect(()=>(u(),()=>{$.fn.DataTable.isDataTable("#resultsTable")&&$("#resultsTable").DataTable().destroy()}),[u]),e.jsxs(N,{children:[e.jsx(g,{title:"Results List"}),e.jsxs(b,{className:"mb-3 align-items-center",children:[e.jsxs(d,{children:[e.jsxs("h1",{className:"h3 mb-0",children:["Form ",l," Results"]}),e.jsxs("p",{className:"text-muted mb-0",children:["Term: ",t.term.term," Exam: ",t.exam]})]}),e.jsx(d,{className:"d-flex justify-content-end",children:e.jsxs(a,{align:"end",children:[e.jsxs(a.Toggle,{variant:"outline-success",id:"dropdown-downloads",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-download me-1"}),"Downloads"]}),e.jsxs(a.Menu,{className:"border-0 shadow-sm",children:[e.jsxs(a.Item,{href:route("pdf.merit",[t.id,l]),target:"_blank",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-file-earmark-pdf text-danger"}),"Pdf"]}),e.jsxs(a.Item,{href:"#/action-2",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-file-earmark-excel text-success"}),"Excel"]}),e.jsxs(a.Item,{href:"#/action-3",className:"d-flex align-items-center gap-2",children:[e.jsx("i",{className:"bi bi-file-earmark-text"}),"Report Forms"]})]})]})})]}),e.jsx("hr",{className:"dashed-hr mb-4"}),e.jsx(b,{children:e.jsx(d,{xs:12,children:e.jsx(p,{className:"border-0 shadow-sm",children:e.jsx(p.Body,{children:e.jsx(w,{bordered:!0,striped:!0,hover:!0,responsive:!0,id:"resultsTable",className:"w-100 mb-0"})})})})})]})}export{S as default};
